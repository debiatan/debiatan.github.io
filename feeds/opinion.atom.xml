<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Transition Dreams - opinion</title><link href="https://blog.debiatan.net/" rel="alternate"></link><link href="https://blog.debiatan.net/feeds/opinion.atom.xml" rel="self"></link><id>https://blog.debiatan.net/</id><updated>2016-02-17T19:00:00+01:00</updated><entry><title>A limitation of GDB frontends</title><link href="https://blog.debiatan.net/a_limitation_of_gdb_frontends.html" rel="alternate"></link><published>2016-02-17T19:00:00+01:00</published><updated>2016-02-17T19:00:00+01:00</updated><author><name>Miguel Lechón</name></author><id>tag:blog.debiatan.net,2016-02-17:/a_limitation_of_gdb_frontends.html</id><summary type="html">&lt;!-- :subtitle: (well, one of them) --&gt;
&lt;p&gt;GDB is an OK command-line debugger, but its not a solid foundation for graphical debuggers. According to the GDB documentation, the recommended way of interacting with the debugger is through &lt;a class="reference external" href="https://sourceware.org/gdb/onlinedocs/gdb/GDB_002fMI.html"&gt;the GDB/MI interface&lt;/a&gt;, which offers almost the same functionality as the regular GDB command-line through an alternative text protocol …&lt;/p&gt;</summary><content type="html">&lt;!-- :subtitle: (well, one of them) --&gt;
&lt;p&gt;GDB is an OK command-line debugger, but its not a solid foundation for graphical debuggers. According to the GDB documentation, the recommended way of interacting with the debugger is through &lt;a class="reference external" href="https://sourceware.org/gdb/onlinedocs/gdb/GDB_002fMI.html"&gt;the GDB/MI interface&lt;/a&gt;, which offers almost the same functionality as the regular GDB command-line through an alternative text protocol with a well-defined but somewhat obtuse grammar. If all we need is the ability to automate a GDB session, then GDB/MI is probably enough, but if we want our frontend to provide functionality not present in GDB, we may be out of luck.&lt;/p&gt;
&lt;p&gt;As an example, let's imagine we want to ask GDB about the value associated to a variable. In a regular command-line debugging session, we would issue a print command specifying the name of the variable and the debugger would look for it inside the blocks encompassing our current line to provide an answer.&lt;/p&gt;
&lt;p&gt;What happens, however, when we try to implement mouseover variable inspection? Suddenly, the current line can't act as an implicit location for our queries and the variable we want to inspect may not be uniquely identified by its name. Take for instance this run-of-the-mill piece of C++ code, representative of my coding style on Friday afternoons:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
      &lt;span class="kt"&gt;float&lt;/span&gt; &lt;span class="n"&gt;thing&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.f&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;
          &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;thing&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
          &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;lets_break_here&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;{&lt;/span&gt;
              &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;thing&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
              &lt;span class="c1"&gt;// thing in a comment&lt;/span&gt;
  &lt;span class="cp"&gt;#if 0&lt;/span&gt;&lt;span class="c"&gt;&lt;/span&gt;
&lt;span class="c"&gt;              thing&lt;/span&gt;
&lt;span class="cp"&gt;  #endif&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

      &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
          &lt;span class="n"&gt;thing&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;thing&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;thing&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;

      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;Let's say we decide to stop on line five and inspect the values associated to all available &lt;tt class="docutils literal"&gt;thing&lt;/tt&gt;s using Emacs' gud-tooltip-mode.&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="Testing gdb-emacs" src="images/gdb_emacs.png" style="width: 599.0px; height: 484.0px;" /&gt;
&lt;/div&gt;
&lt;p&gt;The result are wrong most of the time. Maybe KDevelop has other thoughts on the matter...&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="Testing gdb-kdevelop" src="images/gdb_kdevelop.png" style="width: 603.54px; height: 491.82px;" /&gt;
&lt;/div&gt;
&lt;p&gt;Not really. Qt-creator?&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="Testing gdb-qtcreator" src="images/gdb_qtcreator.png" style="width: 612.72px; height: 513.36px;" /&gt;
&lt;/div&gt;
&lt;p&gt;This one at least does not fall for the commented &lt;tt class="docutils literal"&gt;thing&lt;/tt&gt; and even acknowledges the existence of other types of &lt;tt class="docutils literal"&gt;thing&lt;/tt&gt;s somewhere else in the program. But still, I'm beginning to suspect that GDB frontend programmers don't usually debug the sort of code I tend to work on. The results are the same for Eclipse's CDT standalone debugger and for DDD. I can't say what CLion and Nemiver do, because they refuse to work on my machine.&lt;/p&gt;
&lt;p&gt;Figuring out the lexical scope of variables in C programs is not &lt;em&gt;that&lt;/em&gt; hard. All these frontends fail to implement it properly because GDB makes it hard for them. Sure, they could issue an &lt;tt class="docutils literal"&gt;info scope 7&lt;/tt&gt; command and find out the addresses and sizes of all variables relative to the stack base pointer for all scopes encompassing line seven:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Scope for 7:
Symbol thing is a variable at frame base reg $rbp offset 0+-17, length 1.
Symbol thing is a variable at frame base reg $rbp offset 0+-12, length 4.
Symbol lets_break_here is a variable at frame base reg $rbp offset 0+-16, length 4.
Symbol thing is a variable at frame base reg $rbp offset 0+-8, length 4.
&lt;/pre&gt;
&lt;p&gt;Then, they would only need to infer somehow which &lt;tt class="docutils literal"&gt;thing&lt;/tt&gt;'s which, find its type and format its value accordingly. At this point it may be easier to read the DWARF debug information directly and avoid GDB altogether.&lt;/p&gt;
&lt;p&gt;Or we could just purchase a Windows license, download Visual Studio Community Whatever, register it and...&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="Testing Visual Studio's debugger" src="images/gdb_visual_studio.png" style="width: 613.8px; height: 644.4px;" /&gt;
&lt;p class="caption"&gt;Oops!&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;I suppose the problem here is that the Visual Studio team cares mostly about C#, and since C# does not allow variables with the same name in nested scopes...&lt;/p&gt;
</content><category term="debugger"></category><category term="linux"></category></entry></feed>